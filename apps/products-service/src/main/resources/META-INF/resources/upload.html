<!DOCTYPE html>
<html>

<head>
    <link href="style.css" rel="stylesheet"/>
</head>

<body>
<main>

    <section>
        <form action="/upload" enctype="application/json" method="post">
            Select file to upload:
            <input id="file-selector" name="fileToUpload" type="file">
        </form>
    </section>
</main>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
    const fileSelector = document.getElementById('file-selector');
    fileSelector.addEventListener('change', (event) => {
        const fileList = event.target.files;
        const file = fileList[0];
        const reader = new FileReader();
        reader.addEventListener('load', (event) => {
            console.log(event.target.result);
            $.ajax({
                url: '/upload',
                type: "POST",
                dataType: 'json',
                contentType: 'application/json;charset=UTF-8',
                data: event.target.result,
                success: function (result) {
                    fileSelector.value = '';
                    console.log(result);
                },
                error: function (xhr, resp, text) {
                    fileSelector.value = '';
                    console.log(xhr, resp, text);
                }
            })
        });
        reader.readAsText(file);
    });
</script>
</html>
